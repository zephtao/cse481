"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.finalizeRosConnection = exports.getRosObject = void 0;
var roslib_1 = require("roslib");
var uuid_1 = require("uuid");
var RosInstances = {};
/**
 * Creates a ROS instance and stores it by its URL.
 * Does not connect for you.
 *
 * @param url The URL to connect to. Should not be an empty string
 * @param options Ros constructor parameters, without the URL.
 * @return Ros instance
 */
var getRosObject = function (url, options) {
    if (options === void 0) { options = {}; }
    var rosInstance = new roslib_1.Ros(options);
    rosInstance.uid = (0, uuid_1.v4)();
    if (RosInstances[url] === undefined) {
        // cache miss, store
        RosInstances[url] = rosInstance;
    }
    else {
        rosInstance = RosInstances[url];
    }
    return rosInstance;
};
exports.getRosObject = getRosObject;
var finalizeRosConnection = function (ros, url) {
    ros.close();
    if (ros.uid === undefined || ros.uid === '') {
        return;
    }
    // Remove this tracking uid and the instance
    delete RosInstances[url];
};
exports.finalizeRosConnection = finalizeRosConnection;
//# sourceMappingURL=RosInstanceManager.js.map